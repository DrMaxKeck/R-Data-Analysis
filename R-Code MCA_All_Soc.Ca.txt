########## Dieser Code versucht eine Multiple Korrespondenzanalyse
#mit 0 1 codierten Variablen zu machen. Die 0er Werte sollen keine ROlle spielen
#sondern nur die 1er Werte.

# Wir machen die Correspondence analyse mit dem Paket soc.ca
# dieses Paket kann auch mit fehlenden Werte umgehen.

# Wichtig ist: Die Datei die eingelesen wird muß so vorliegen, dass Fälle in den Zeilen sind
# und die Variablen in den Spalten. Auch habe ich immer die Identifikationsnummern (Zum Beispiel im
# SOEP) weggemacht.

# Cran mirror automatisch setzen 

chooseCRANmirror("https://cran.uni-muenster.de")
39

#paket installieren um spss daten einzulesen
if (!require(haven)) {install.packages("haven")} 
library (haven)

# Cran mirror automatisch setzen 

chooseCRANmirror("https://cran.uni-muenster.de")
39

#Sprache auf Englisch umstellen
Sys.setenv(LANG = "en")

data_spss <- read_sav ("XX/Factominer_Null_keine_Missing.sav")

# Soc.ca installieren
if (!require(soc.ca)) {install.packages("soc.ca")} 
library (soc.ca)

attach(data_spss)

desired_levels <- c("0", "1")

# Die Variablen als Faktoren definieren, damit die MCA gemacht werden kann.
for (col in colnames(data_spss)) { data_spss[[col]] <- factor(data_spss[[col]], levels = desired_levels)}

# Soc.ca installieren
if (!require(soc.ca)) {install.packages("soc.ca")} 
library (soc.ca)

active <- data_spss
options (passive=0)

result <- soc.mca(active, sup = NULL, identifier = NULL, passive = getOption("passive", default = "Missing"),
weight = NULL, Moschidis = FALSE,detailed.results = FALSE)
